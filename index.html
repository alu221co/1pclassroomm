<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Classroom</title>

<link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&family=Press+Start+2P&display=swap" rel="stylesheet">

<style>
  body {
    margin: 0;
    font-family: 'Roboto', sans-serif;
    background: linear-gradient(45deg, #ff416c, #f88391ff, #2080b3ff, #99f2c8);
    background-size: 400% 400%;
    animation: bgAnim 20s ease infinite;
    color: #fff;
    min-height: 100vh;
    display: flex;
    flex-direction: column;
    overflow: hidden;
  }

  @keyframes bgAnim {
    0% { background-position: 0% 50%; }
    50% { background-position: 100% 50%; }
    100% { background-position: 0% 50%; }
  }

  header {
    padding: 20px;
    text-align: center;
    background: rgba(0,0,0,0.5);
    border-bottom: 2px solid #ffdd59;
    box-shadow: 0 5px 20px rgba(0,0,0,0.6);
  }

  header h1 {
    font-size: 2.3em;
    color: #ffdd59;
    text-shadow: 0 0 10px #fffb7d;
  }

  .games-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
    gap: 30px;
    padding: 50px;
    max-width: 1200px;
    margin: auto;
    width: 100%;
  }

  .game-card {
    background: rgba(255,255,255,0.1);
    border-radius: 18px;
    padding: 30px;
    text-align: center;
    backdrop-filter: blur(15px);
    box-shadow: 0 6px 25px rgba(0,0,0,0.4);
    transition: all 0.3s ease;
    cursor: pointer;
    font-family: 'Press Start 2P', cursive;
    border: 2px solid rgba(255, 221, 89, 0.3);
  }

  .game-card:hover {
    transform: translateY(-10px) scale(1.05);
    box-shadow: 0 12px 40px rgba(0,0,0,0.7), 0 0 20px #ffdd59;
    border-color: #ffdd59;
  }

  .game-card h3 {
    font-size: 1.3em;
    color: #ffdd59;
    text-shadow: 0 0 8px #fffb7d;
    margin-top: 10px;
  }

  #gamePanel {
    display: none;
    width: 100%;
    height: 100vh;
    background: #000;
    position: fixed;
    top: 0; left: 0;
    z-index: 1000;
    flex-direction: column;
    justify-content: center;
    align-items: center;
  }

  #closeBtn {
    position: absolute;
    top: 20px;
    right: 20px;
    background: #ff416c;
    color: #fff;
    border: none;
    padding: 10px 18px;
    font-size: 16px;
    border-radius: 8px;
    cursor: pointer;
    box-shadow: 0 0 12px rgba(0,0,0,0.6);
  }

  #game {
    width: 100%;
    height: 100%;
    display: flex;
    justify-content: center;
    align-items: center;
  }

  /* Canvas para Tetris centrado */
  #tetrisCanvas {
    border: 4px solid #ffdd59;
    background: #111;
    display: block;
    margin: 0 auto;
  }
</style>
</head>
<body>

<header>
  <h1>Golozapiens Studio</h1>
</header>

<div class="games-grid">
  <div class="game-card" onclick="startTetris()">
    <h3>üü¶ Tetris</h3>
  </div>
  <div class="game-card" onclick="startMario()">
    <h3>üçÑ Mariano Bros</h3>
  </div>
</div>

<div id="gamePanel" style="display:none;">
  <button id="closeBtn" onclick="closeGame()">Cerrar</button>
  <div id="game"></div>
</div>

<script>
const gameDiv = document.getElementById('game');
const panel = document.getElementById('gamePanel');

function closeGame() {
  gameDiv.innerHTML = '';
  panel.style.display = 'none';
}

// ------------------- Tetris -------------------
function startTetris() {
  panel.style.display = 'flex';
  gameDiv.innerHTML = `
    <canvas id="tetrisCanvas" width="300" height="600"></canvas>
    <div style="position:absolute;top:20px;left:20px;color:#ffdd59;font-family:'Press Start 2P';">Score: <span id="score">0</span></div>
  `;

  const canvas = document.getElementById('tetrisCanvas');
  const ctx = canvas.getContext('2d');
  const cols = 10;
  const rows = 20;
  const blockSize = canvas.width / cols;
  let board = Array.from({length: rows}, ()=> Array(cols).fill(0));
  let current = null;
  let score = 0;
  let dropCounter = 0;
  let dropInterval = 400; // velocidad inicial
  let lastTime = 0;

  const colors = ['cyan','blue','orange','yellow','green','purple','red'];
  const pieces = [
    [[1,1,1,1]],           // I
    [[1,0,0],[1,1,1]],     // J
    [[0,0,1],[1,1,1]],     // L
    [[1,1],[1,1]],         // O
    [[0,1,1],[1,1,0]],     // S
    [[0,1,0],[1,1,1]],     // T
    [[1,1,0],[0,1,1]]      // Z
  ];

  function randomPiece() {
    const id = Math.floor(Math.random()*pieces.length);
    return {shape: pieces[id], color: colors[id], x: Math.floor(cols/2)-1, y:0};
  }

  function drawBlock(x,y,color) {
    ctx.fillStyle = color;
    ctx.fillRect(x*blockSize, y*blockSize, blockSize-1, blockSize-1);
  }

  function drawBoard() {
    ctx.clearRect(0,0,canvas.width,canvas.height);

    // Cuadr√≠cula
    ctx.strokeStyle = "#222"; 
    ctx.lineWidth = 1;
    for (let x = 0; x <= cols; x++) {
      ctx.beginPath();
      ctx.moveTo(x * blockSize, 0);
      ctx.lineTo(x * blockSize, canvas.height);
      ctx.stroke();
    }
    for (let y = 0; y <= rows; y++) {
      ctx.beginPath();
      ctx.moveTo(0, y * blockSize);
      ctx.lineTo(canvas.width, y * blockSize);
      ctx.stroke();
    }

    // Piezas fijas
    for(let y=0;y<rows;y++)
      for(let x=0;x<cols;x++)
        if(board[y][x]) drawBlock(x,y,board[y][x]);

    // Pieza actual
    if(current) {
      current.shape.forEach((row,dy)=> row.forEach((val,dx)=>{
        if(val) drawBlock(current.x+dx, current.y+dy, current.color);
      }));
    }
  }

  function collide(nx,ny,shape) {
    return shape.some((row,dy)=> row.some((val,dx)=>{
      let x = nx+dx, y=ny+dy;
      return val && (x<0 || x>=cols || y>=rows || board[y][x]);
    }));
  }

  function merge() {
    current.shape.forEach((row,dy)=> row.forEach((val,dx)=>{
      if(val) board[current.y+dy][current.x+dx] = current.color;
    }));
  }

  function sweep() {
    let lines = 0;
    for(let y=rows-1;y>=0;y--) {
      if(board[y].every(val=>val)) {
        board.splice(y,1);
        board.unshift(Array(cols).fill(0));
        lines++;
        y++;
      }
    }
    score += lines*100;
    document.getElementById('score').innerText = score;
    if(lines > 0 && dropInterval > 100) {
      dropInterval -= 20; // aumenta velocidad progresivamente
    }
  }

  function drop() {
    if(!current) current = randomPiece();
    if(!collide(current.x,current.y+1,current.shape)) {
      current.y++;
    } else {
      merge();
      if(current.y<=0) { alert('Game Over'); current=null; board = Array.from({length: rows}, ()=> Array(cols).fill(0)); score=0; dropInterval=400; document.getElementById('score').innerText = score; return; }
      sweep();
      current = randomPiece();
    }
  }

  function update(time=0) {
    const delta = time - lastTime;
    lastTime = time;
    dropCounter += delta;
    if(dropCounter > dropInterval) {
      drop();
      dropCounter = 0;
    }
    drawBoard();
    requestAnimationFrame(update);
  }
  update();

  document.addEventListener('keydown',e=>{
    if(!current) return;
    if(e.key==='ArrowLeft' && !collide(current.x-1,current.y,current.shape)) current.x--;
    if(e.key==='ArrowRight' && !collide(current.x+1,current.y,current.shape)) current.x++;
    if(e.key==='ArrowDown' && !collide(current.x,current.y+1,current.shape)) current.y++;
    if(e.key==='ArrowUp') {
      let shape = current.shape[0].map((_,i)=> current.shape.map(row=> row[i]).reverse());
      if(!collide(current.x,current.y,shape)) current.shape=shape;
    }
  });
}

// ------------------- Mario -------------------
function startMario() {
  panel.style.display = 'flex';
  gameDiv.innerHTML = `
    <div id="marioGame" style="width:100%;height:100%;"></div>
  `;
  EJS_player = "#marioGame";
  EJS_core = "nes";
  EJS_color = "#000000";
  EJS_startOnLoaded = true;
  EJS_pathtodata = "https://cdn.jsdelivr.net/gh/a456pur/seraph@81f551ca0aa8e3d6018d32d8ac5904ac9bc78f76/storage/emulatorjs/data";
  EJS_gameUrl = "https://cdn.jsdelivr.net/gh/bubbls/UGS-file-encryption@e0c78a58432c6486ebe1a50a78d263df65809a83/Super%20Mario%20Bros.%20(Europe).zip";
  loadGame();
}

function loadGame() {
  if(!window.loaderIncluded) {
    window.loaderIncluded=true;
    let script = document.createElement("script");
    script.src="https://cdn.jsdelivr.net/gh/a456pur/seraph@81f551ca0aa8e3d6018d32d8ac5904ac9bc78f76/storage/emulatorjs/data/loader.js";
    document.body.appendChild(script);
  }
}
</script>

</body>
</html>
