<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Classroom</title>

<link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&family=Press+Start+2P&display=swap" rel="stylesheet">

<style>
  body {
    margin: 0;
    font-family: 'Roboto', sans-serif;
    background: linear-gradient(45deg, #ff416c, #f88391ff, #2080b3ff, #99f2c8);
    background-size: 400% 400%;
    animation: bgAnim 20s ease infinite;
    color: #fff;
    min-height: 100vh;
    display: flex;
    flex-direction: column;
    overflow: hidden;
  }

  @keyframes bgAnim {
    0% { background-position: 0% 50%; }
    50% { background-position: 100% 50%; }
    100% { background-position: 0% 50%; }
  }

  header {
    padding: 20px;
    text-align: center;
    background: rgba(0,0,0,0.5);
    border-bottom: 2px solid #ffdd59;
    box-shadow: 0 5px 20px rgba(0,0,0,0.6);
  }

  header h1 {
    font-size: 2.3em;
    color: #ffdd59;
    text-shadow: 0 0 10px #fffb7d;
  }

  .games-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
    gap: 30px;
    padding: 50px;
    max-width: 1200px;
    margin: auto;
    width: 100%;
  }

  .game-card {
    background: rgba(255,255,255,0.1);
    border-radius: 18px;
    padding: 30px;
    text-align: center;
    backdrop-filter: blur(15px);
    box-shadow: 0 6px 25px rgba(0,0,0,0.4);
    transition: all 0.3s ease;
    cursor: pointer;
    font-family: 'Press Start 2P', cursive;
    border: 2px solid rgba(255, 221, 89, 0.3);
  }

  .game-card:hover {
    transform: translateY(-10px) scale(1.05);
    box-shadow: 0 12px 40px rgba(0,0,0,0.7), 0 0 20px #ffdd59;
    border-color: #ffdd59;
  }

  .game-card h3 {
    font-size: 1.3em;
    color: #ffdd59;
    text-shadow: 0 0 8px #fffb7d;
    margin-top: 10px;
  }

  #gamePanel {
    display: none;
    width: 100%;
    height: 100vh;
    background: #000;
    position: fixed;
    top: 0; left: 0;
    z-index: 1000;
    flex-direction: column;
    justify-content: center;
    align-items: center;
  }

  #closeBtn {
    position: absolute;
    top: 20px;
    right: 20px;
    background: #ff416c;
    color: #fff;
    border: none;
    padding: 10px 18px;
    font-size: 16px;
    border-radius: 8px;
    cursor: pointer;
    box-shadow: 0 0 12px rgba(0,0,0,0.6);
  }

  #game {
    width: 100%;
    height: 100%;
    display: flex;
    justify-content: center;
    align-items: center;
  }

  #tetrisCanvas, #pongCanvas {
    border: 4px solid #ffdd59;
    background: #111;
    display: block;
    margin: 0 auto;
  }
</style>
</head>
<body>

<header>
  <h1>Golozapiens Studio</h1>
</header>

<div class="games-grid">
  <div class="game-card" onclick="startTetris()">
    <h3>üü¶ Tetris</h3>
  </div>
  <div class="game-card" onclick="startMario()">
    <h3>üçÑ Mario Bros</h3>
  </div>
  <div class="game-card" onclick="startPong()">
    <h3>üèì Pong</h3>
  </div>
  <div class="game-card" onclick="startFutbol()">
    <h3>‚öΩ F√∫tbol 2D</h3>
  </div>
</div>

<div id="gamePanel" style="display:none;">
  <button id="closeBtn" onclick="closeGame()">Cerrar</button>
  <div id="game"></div>
</div>

<script>
const gameDiv = document.getElementById('game');
const panel = document.getElementById('gamePanel');

function closeGame() {
  gameDiv.innerHTML = '';
  panel.style.display = 'none';
}

// ------------------- Tetris -------------------
function startTetris() {
  panel.style.display = 'flex';
  gameDiv.innerHTML = `
    <canvas id="tetrisCanvas" width="300" height="600"></canvas>
    <div style="position:absolute;top:20px;left:20px;color:#ffdd59;font-family:'Press Start 2P';">Score: <span id="score">0</span></div>
  `;

  const canvas = document.getElementById('tetrisCanvas');
  const ctx = canvas.getContext('2d');
  const cols = 10;
  const rows = 20;
  const blockSize = canvas.width / cols;
  let board = Array.from({length: rows}, ()=> Array(cols).fill(0));
  let current = null;
  let score = 0;
  let dropCounter = 0;
  let dropInterval = 400;
  let lastTime = 0;

  const colors = ['cyan','blue','orange','yellow','green','purple','red'];
  const pieces = [
    [[1,1,1,1]],
    [[1,0,0],[1,1,1]],
    [[0,0,1],[1,1,1]],
    [[1,1],[1,1]],
    [[0,1,1],[1,1,0]],
    [[0,1,0],[1,1,1]],
    [[1,1,0],[0,1,1]]
  ];

  function randomPiece() {
    const id = Math.floor(Math.random()*pieces.length);
    return {shape: pieces[id], color: colors[id], x: Math.floor(cols/2)-1, y:0};
  }

  function drawBlock(x,y,color) {
    ctx.fillStyle = color;
    ctx.fillRect(x*blockSize, y*blockSize, blockSize-1, blockSize-1);
  }

  function drawBoard() {
    ctx.clearRect(0,0,canvas.width,canvas.height);

    ctx.strokeStyle = "#222"; 
    ctx.lineWidth = 1;
    for (let x = 0; x <= cols; x++) {
      ctx.beginPath();
      ctx.moveTo(x * blockSize, 0);
      ctx.lineTo(x * blockSize, canvas.height);
      ctx.stroke();
    }
    for (let y = 0; y <= rows; y++) {
      ctx.beginPath();
      ctx.moveTo(0, y * blockSize);
      ctx.lineTo(canvas.width, y * blockSize);
      ctx.stroke();
    }

    for(let y=0;y<rows;y++)
      for(let x=0;x<cols;x++)
        if(board[y][x]) drawBlock(x,y,board[y][x]);

    if(current) {
      current.shape.forEach((row,dy)=> row.forEach((val,dx)=>{
        if(val) drawBlock(current.x+dx, current.y+dy, current.color);
      }));
    }
  }

  function collide(nx,ny,shape) {
    return shape.some((row,dy)=> row.some((val,dx)=>{
      let x = nx+dx, y=ny+dy;
      return val && (x<0 || x>=cols || y>=rows || board[y][x]);
    }));
  }

  function merge() {
    current.shape.forEach((row,dy)=> row.forEach((val,dx)=>{
      if(val) board[current.y+dy][current.x+dx] = current.color;
    }));
  }

  function sweep() {
    let lines = 0;
    for(let y=rows-1;y>=0;y--) {
      if(board[y].every(val=>val)) {
        board.splice(y,1);
        board.unshift(Array(cols).fill(0));
        lines++;
        y++;
      }
    }
    score += lines*100;
    document.getElementById('score').innerText = score;
    if(lines > 0 && dropInterval > 100) dropInterval -= 20;
  }

  function drop() {
    if(!current) current = randomPiece();
    if(!collide(current.x,current.y+1,current.shape)) {
      current.y++;
    } else {
      merge();
      if(current.y<=0) { alert('Game Over'); current=null; board = Array.from({length: rows}, ()=> Array(cols).fill(0)); score=0; dropInterval=400; document.getElementById('score').innerText = score; return; }
      sweep();
      current = randomPiece();
    }
  }

  function update(time=0) {
    const delta = time - lastTime;
    lastTime = time;
    dropCounter += delta;
    if(dropCounter > dropInterval) {
      drop();
      dropCounter = 0;
    }
    drawBoard();
    requestAnimationFrame(update);
  }
  update();

  document.addEventListener('keydown',e=>{
    if(!current) return;
    if(e.key==='ArrowLeft' && !collide(current.x-1,current.y,current.shape)) current.x--;
    if(e.key==='ArrowRight' && !collide(current.x+1,current.y,current.shape)) current.x++;
    if(e.key==='ArrowDown' && !collide(current.x,current.y+1,current.shape)) current.y++;
    if(e.key==='ArrowUp') {
      let shape = current.shape[0].map((_,i)=> current.shape.map(row=> row[i]).reverse());
      if(!collide(current.x,current.y,shape)) current.shape=shape;
    }
  });
}

// ------------------- Mario -------------------
function startMario() {
  panel.style.display = 'flex';
  gameDiv.innerHTML = `<div id="marioGame" style="width:100%;height:100%;"></div>`;
  EJS_player = "#marioGame";
  EJS_core = "nes";
  EJS_color = "#000000";
  EJS_startOnLoaded = true;
  EJS_pathtodata = "https://cdn.jsdelivr.net/gh/a456pur/seraph@81f551ca0aa8e3d6018d32d8ac5904ac9bc78f76/storage/emulatorjs/data";
  EJS_gameUrl = "https://cdn.jsdelivr.net/gh/bubbls/UGS-file-encryption@e0c78a58432c6486ebe1a50a78d263df65809a83/Super%20Mario%20Bros.%20(Europe).zip";
  loadGame();
}

function loadGame() {
  if(!window.loaderIncluded) {
    window.loaderIncluded=true;
    let script = document.createElement("script");
    script.src="https://cdn.jsdelivr.net/gh/a456pur/seraph@81f551ca0aa8e3d6018d32d8ac5904ac9bc78f76/storage/emulatorjs/data/loader.js";
    document.body.appendChild(script);
  }
}

// ------------------- Pong -------------------
function startPong() {
  panel.style.display = 'flex';
  gameDiv.innerHTML = `
    <canvas id="pongCanvas" width="800" height="500"></canvas>
    <div style="position:absolute;top:20px;left:20px;color:#ffdd59;font-family:'Press Start 2P';">
      IA: <select id="difficulty">
        <option value="easy">F√°cil</option>
        <option value="medium" selected>Medio</option>
        <option value="hard">Dif√≠cil</option>
      </select>
    </div>
  `;

  const canvas = document.getElementById("pongCanvas");
  const ctx = canvas.getContext("2d");

  const paddleHeight = 90, paddleWidth = 12;
  const player = { x: 20, y: canvas.height/2 - paddleHeight/2, score: 0 };
  const ai = { x: canvas.width-32, y: canvas.height/2 - paddleHeight/2, score: 0 };
  const ball = { x: canvas.width/2, y: canvas.height/2, r: 9, speedX: 0, speedY: 0 };

  let upPressed = false, downPressed = false;

  document.addEventListener("keydown", e => {
    if(e.key==="ArrowUp") upPressed=true;
    if(e.key==="ArrowDown") downPressed=true;
  });
  document.addEventListener("keyup", e => {
    if(e.key==="ArrowUp") upPressed=false;
    if(e.key==="ArrowDown") downPressed=false;
  });

  function resetBall() {
    ball.x = canvas.width/2;
    ball.y = canvas.height/2;
    ball.speedX = (Math.random()>0.5?1:-1) * 2.5;
    ball.speedY = (Math.random()>0.5?1:-1) * 2.5;
  }

  function drawRect(x,y,w,h,color) {
    ctx.fillStyle=color;
    ctx.fillRect(x,y,w,h);
  }

  function drawCircle(x,y,r,color) {
    ctx.fillStyle=color;
    ctx.beginPath();
    ctx.arc(x,y,r,0,Math.PI*2,false);
    ctx.closePath();
    ctx.fill();
  }

  function drawText(text,x,y,color) {
    ctx.fillStyle=color;
    ctx.font="28px 'Press Start 2P'";
    ctx.shadowColor = "#ffdd59";
    ctx.shadowBlur = 15;
    ctx.fillText(text,x,y);
    ctx.shadowBlur = 0;
  }

  function drawNet() {
    ctx.strokeStyle="#333";
    ctx.lineWidth=2;
    for(let i=0;i<=canvas.height;i+=15){
      ctx.beginPath();
      ctx.moveTo(canvas.width/2,i);
      ctx.lineTo(canvas.width/2,i+10);
      ctx.stroke();
    }
  }

  function collision(b,p) {
    return b.x - b.r < p.x + paddleWidth &&
           b.x + b.r > p.x &&
           b.y - b.r < p.y + paddleHeight &&
           b.y + b.r > p.y;
  }

  function getDifficulty() {
    const mode = document.getElementById("difficulty").value;
    if(mode==="easy") return {react:0.05, speed:4};
    if(mode==="medium") return {react:0.1, speed:6};
    if(mode==="hard") return {react:0.18, speed:9};
  }

  function update() {
    if(upPressed && player.y>0) player.y-=6;
    if(downPressed && player.y<canvas.height-paddleHeight) player.y+=6;

    let diff = getDifficulty();
    let targetY = ball.y - (ai.y + paddleHeight/2);
    if(Math.abs(targetY) > 10) ai.y += Math.sign(targetY) * Math.min(diff.speed, Math.abs(targetY) * diff.react);

    ball.x += ball.speedX;
    ball.y += ball.speedY;

    if(ball.y+ball.r>canvas.height || ball.y-ball.r<0) ball.speedY*=-1;

    let paddle = (ball.x<canvas.width/2)?player:ai;
    if(collision(ball,paddle)){
      let collidePoint = (ball.y - (paddle.y + paddleHeight/2)) / (paddleHeight/2);
      let angleRad = (Math.PI/4) * collidePoint;
      let direction = (ball.x<canvas.width/2)?1:-1;
      let speed = Math.sqrt(ball.speedX**2 + ball.speedY**2) + 0.5;
      ball.speedX = speed * Math.cos(angleRad) * direction;
      ball.speedY = speed * Math.sin(angleRad);
    }

    if(ball.x-ball.r<0){ ai.score++; resetBall(); }
    if(ball.x+ball.r>canvas.width){ player.score++; resetBall(); }
  }

  function render() {
    drawRect(0,0,canvas.width,canvas.height,"#000");
    drawNet();
    drawText(player.score,canvas.width/4,60,"#ffdd59");
    drawText(ai.score,3*canvas.width/4,60,"#ffdd59");
    drawRect(player.x,player.y,paddleWidth,paddleHeight,"#fff");
    drawRect(ai.x,ai.y,paddleWidth,paddleHeight,"#fff");
    drawCircle(ball.x,ball.y,ball.r,"#ff416c");
  }

  function game(){
    update();
    render();
    requestAnimationFrame(game);
  }
  resetBall();
  game();
}

// ------------------- F√∫tbol 2D -------------------
function startFutbol() {
  panel.style.display = 'flex';
  gameDiv.innerHTML = `
    <canvas id="futbolCanvas" width="900" height="560"></canvas>
    <div style="position:absolute;top:20px;left:20px;color:#ffdd59;font-family:'Press Start 2P';">
      IA: <select id="difficultyFutbol">
        <option value="easy">F√°cil</option>
        <option value="medium" selected>Medio</option>
        <option value="hard">Dif√≠cil</option>
      </select>
    </div>
  `;

  const canvas = document.getElementById("futbolCanvas");
  const ctx = canvas.getContext("2d");

  const keys = {};
  let paused = false;

  document.addEventListener("keydown", e => keys[e.key] = true);
  document.addEventListener("keyup", e => keys[e.key] = false);

  const ball = {x:450,y:280,vx:5,vy:3,r:18};
  const p1 = {x:260,y:240,w:48,h:48,score:0,color:'#66ccff',speed:4};
  const p2 = {x:540,y:240,w:48,h:48,score:0,color:'#ff7777',speed:4}; // IA
  const goalSize = 340;
  const goalie1 = {x:10,y:280,w:12,h:60,speed:1.2};
  const goalie2 = {x:878,y:280,w:12,h:60,speed:1.2};

  let finished = false;

  function clamp(v,min,max){ return Math.max(min,Math.min(max,v)); }

  function respawn() {
    ball.x = 450; ball.y = 280;
    ball.vx = (Math.random()>0.5?5:-5);
    ball.vy = (Math.random()>0.5?3:-3);
  }

  function drawField() {
    ctx.fillStyle='#083708';
    ctx.fillRect(0,0,900,560);
    for(let y=0;y<11;y++){
      ctx.fillStyle = y%2 ? '#073306' : '#083708';
      ctx.fillRect(0,y*50,900,25);
    }
    ctx.strokeStyle='white';
    ctx.lineWidth=2;
    ctx.strokeRect(0,0,900,560);
    ctx.beginPath(); ctx.moveTo(450,0); ctx.lineTo(450,560); ctx.stroke();
    ctx.beginPath(); ctx.arc(450,280,80,0,2*Math.PI); ctx.stroke();
    ctx.strokeRect(0,(560-goalSize)/2,18,goalSize); 
    ctx.strokeRect(882,(560-goalSize)/2,18,goalSize);
  }

  function draw() {
    drawField();
    ctx.fillStyle='#cccccc';
    ctx.fillRect(goalie1.x,goalie1.y-goalie1.h/2,goalie1.w,goalie1.h);
    ctx.fillRect(goalie2.x,goalie2.y-goalie2.h/2,goalie2.w,goalie2.h);
    ctx.fillStyle=p1.color; ctx.fillRect(p1.x,p1.y,p1.w,p1.h);
    ctx.fillStyle=p2.color; ctx.fillRect(p2.x,p2.y,p2.w,p2.h);
    ctx.fillStyle='white'; ctx.beginPath(); ctx.arc(ball.x,ball.y,ball.r,0,2*Math.PI); ctx.fill();
    ctx.fillStyle='#7CFC00'; ctx.font='18px monospace'; 
    ctx.fillText(`P1: ${p1.score}   P2: ${p2.score}`, 380, 28);
    ctx.fillStyle='white'; ctx.font='12px monospace'; 
    ctx.fillText('ESC pausa',12,548);
  }

  function endGame(winner){
    finished = true;
    alert(winner ? (winner==='p1'?'Gan√≥ P1':'Gan√≥ IA') : 'Empate');
  }

  function update() {
    if(paused || finished) return;

    // Controles P1
    if(keys['w']) p1.y = clamp(p1.y-p1.speed,0,560-p1.h);
    if(keys['s']) p1.y = clamp(p1.y+p1.speed,0,560-p1.h);
    if(keys['a']) p1.x = clamp(p1.x-p1.speed,0,900-p1.w);
    if(keys['d']) p1.x = clamp(p1.x+p1.speed,0,900-p1.w);

    // IA P2
    const diffMode = document.getElementById("difficultyFutbol").value;
    let react=diffMode==='easy'?0.02:diffMode==='medium'?0.05:0.1;
    let speed = diffMode==='easy'?3:diffMode==='medium'?4:6;

    const targetX = ball.x - p2.x - p2.w/2;
    const targetY = ball.y - p2.y - p2.h/2;

    p2.x += clamp(targetX*react,-speed,speed);
    p2.y += clamp(targetY*react,-speed,speed);
    p2.x = clamp(p2.x,0,900-p2.w);
    p2.y = clamp(p2.y,0,560-p2.h);

    // Movimiento pelota
    ball.x += ball.vx; ball.y += ball.vy;
    if(ball.y-ball.r<0){ ball.y=ball.r; ball.vy*=-1; }
    if(ball.y+ball.r>560){ ball.y=560-ball.r; ball.vy*=-1; }

    // Gol
    if(ball.x-ball.r<=0){
      if(ball.y>(560-goalSize)/2 && ball.y<(560+goalSize)/2){ p2.score++; respawn(); } 
      else { ball.x=ball.r; ball.vx*=-1; }
    }
    if(ball.x+ball.r>=900){
      if(ball.y>(560-goalSize)/2 && ball.y<(560+goalSize)/2){ p1.score++; respawn(); } 
      else { ball.x=900-ball.r; ball.vx*=-1; }
    }

    // Colisiones jugadores
    [p1,p2].forEach(p=>{
      const cx=p.x+p.w/2, cy=p.y+p.h/2;
      const dx=ball.x-cx, dy=ball.y-cy;
      const dist=Math.hypot(dx,dy);
      const minDist=ball.r + Math.max(p.w,p.h)/2;
      if(dist<minDist){
        const angle=Math.atan2(dy,dx);
        const speed=Math.max(6,Math.hypot(ball.vx,ball.vy));
        ball.vx = Math.cos(angle)*speed; ball.vy = Math.sin(angle)*speed;
        ball.x = cx + Math.cos(angle)*(minDist+1); 
        ball.y = cy + Math.sin(angle)*(minDist+1);
      }
    });

    // Porteros simples
    if(ball.x<380){ if(Math.abs(goalie1.y-ball.y)>4) goalie1.y += (ball.y>goalie1.y?goalie1.speed:-goalie1.speed); } 
    else { const c=280; if(Math.abs(goalie1.y-c)>1) goalie1.y+=(c>goalie1.y?0.6:-0.6); }

    if(ball.x>520){ if(Math.abs(goalie2.y-ball.y)>4) goalie2.y += (ball.y>goalie2.y?goalie2.speed:-goalie2.speed); } 
    else { const c=280; if(Math.abs(goalie2.y-c)>1) goalie2.y+=(c>goalie2.y?0.6:-0.6); }

    // Hitbox porteros
    const g1 = {x:goalie1.x,y:goalie1.y-goalie1.h/2,w:goalie1.w,h:goalie1.h};
    const g2 = {x:goalie2.x,y:goalie2.y-goalie2.h/2,w:goalie2.w,h:goalie2.h};
    if(ball.x-ball.r<g1.x+g1.w && ball.y>g1.y && ball.y<g1.y+g1.h){ ball.x=g1.x+g1.w+ball.r; ball.vx=Math.abs(ball.vx); }
    if(ball.x+ball.r>g2.x && ball.y>g2.y && ball.y<g2.y+g2.h){ ball.x=g2.x-ball.r; ball.vx=-Math.abs(ball.vx); }

    if(p1.score>=5 || p2.score>=5){ endGame(p1.score>p2.score?'p1':'p2'); }
  }

  function loop(){
    update();
    draw();
    requestAnimationFrame(loop);
  }

  respawn();
  loop();
}
</script>

</body>
</html>


